# ============================================
# Dev Environment ZSH Configuration
# Appended to default .zshrc
# ============================================

# Oh-My-Zsh plugins
plugins=(
    git
    docker
    docker-compose
    zsh-autosuggestions
    zsh-syntax-highlighting
    fzf
    history-substring-search
)

# Theme (Starship is also great if you want to install it)
ZSH_THEME="robbyrussell"

# ============================================
# PATH additions
# ============================================
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.claude/bin:$PATH"

# ============================================
# Editor
# ============================================
export EDITOR="code --wait"
export VISUAL="code --wait"

# ============================================
# Common aliases
# ============================================

# Navigation
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."
alias ~="cd ~"
alias -- -="cd -"

# Modern replacements (if installed)
command -v eza &> /dev/null && alias ls="eza --icons"
command -v eza &> /dev/null && alias ll="eza -la --icons"
command -v eza &> /dev/null && alias tree="eza --tree --icons"
command -v bat &> /dev/null && alias cat="bat --style=plain"
command -v fd &> /dev/null && alias find="fd"
command -v rg &> /dev/null && alias grep="rg"

# Docker
alias d="docker"
alias dc="docker compose"
alias dps="docker ps"
alias dpsa="docker ps -a"
alias di="docker images"
alias drm="docker rm"
alias drmi="docker rmi"
alias dprune="docker system prune -af"
alias dlogs="docker logs -f"
alias dexec="docker exec -it"

# Git
alias g="git"
alias gs="git status"
alias ga="git add"
alias gaa="git add --all"
alias gc="git commit"
alias gcm="git commit -m"
alias gp="git push"
alias gpl="git pull"
alias gf="git fetch"
alias gb="git branch"
alias gco="git checkout"
alias gcb="git checkout -b"
alias gd="git diff"
alias glog="git log --oneline --graph --decorate"
alias gstash="git stash"
alias gpop="git stash pop"

# Claude Code
alias c="claude"
alias cc="claude chat"
alias cr="claude --resume"

# Utility
alias h="history"
alias cls="clear"
alias reload="source ~/.zshrc"
alias path='echo -e ${PATH//:/\\n}'

# ============================================
# Functions
# ============================================

# Create directory and cd into it
mkcd() {
    mkdir -p "$1" && cd "$1"
}

# Quick find file by name
ff() {
    find . -name "*$1*" 2>/dev/null
}

# Docker shell into container
dsh() {
    docker exec -it "$1" /bin/bash || docker exec -it "$1" /bin/sh
}

# ============================================
# FZF Configuration
# ============================================
if command -v fzf &> /dev/null; then
    export FZF_DEFAULT_OPTS='--height 40% --layout=reverse --border'
    
    if command -v fd &> /dev/null; then
        export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'
        export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
    fi
fi

# ============================================
# History configuration
# ============================================
HISTSIZE=50000
SAVEHIST=50000
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE
setopt SHARE_HISTORY

# ============================================
# Welcome message
# ============================================
echo ""
echo "üöÄ Dev environment ready!"
echo "   Claude Code: 'claude' or 'c'"
echo "   MCP servers: 'claude mcp list'"
echo ""
echo "   ‚ÑπÔ∏è  If icons appear as boxes, install Nerd Font on your Mac:"
echo "      brew install --cask font-meslo-lg-nerd-font"
echo ""
